{"version":3,"file":"node_modules_tei_retail-admin_fesm2020_tei-retail-admin-site-online-setup-categories_module-1-d44142.js","mappings":"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","sources":["./projects/tei/retail-admin/src/lib/pages/sites-configuration/site-online-setup/site-online-setup-categories/site-online-setup-categories.component.html","./projects/tei/retail-admin/src/lib/pages/sites-configuration/site-online-setup/site-online-setup-categories/site-online-setup-categories.component.ts","./projects/tei/retail-admin/src/lib/pages/sites-configuration/site-online-setup/site-online-setup-categories/site-online-setup-categories.module.ts"],"sourcesContent":["<tei-retail-retail-admin-right-side-action-bar-page-template>\r\n  <div class=\"container-shell\">\r\n    <div class=\"overflow-hidden mb-3\">\r\n      <div class=\"row\">\r\n        <div class=\"col-md-12\">\r\n          <div class=\"m-breadcrumb\">\r\n            <tei-material-bread-crumb *ngIf=\"breadCrumbData.length\" [breadCrumbData]=\"breadCrumbData\">\r\n            </tei-material-bread-crumb>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"p-category-container\">\r\n        <div class=\"d-flex justify-content-between align-items-center mb-2\">\r\n          <div class=\"a-text-h3\">{{'RETAIL_RETAIL_ADMIN.CATEGORIES.CATEGORIES' | teiTextTranslate}}</div>\r\n          <div class=\"\">\r\n            <button *ngIf=\"showAddCategoryButton\" mat-raised-button type=\"button\" color=\"primary\" class=\"\"\r\n              (click)=\"openCreateCategoryDialog()\">{{'RETAIL_RETAIL_ADMIN.CATEGORIES.ADD_CATEGORY' |\r\n              teiTextTranslate}}</button>\r\n          </div>\r\n        </div>\r\n\r\n        <mat-card class=\"o-card\">\r\n          <div class=\"d-flex flex-wrap o-tree-page-list\">\r\n            <mat-tree class=\"o-card outline mat-tree p-0 w-100\" [dataSource]=\"dataSource\" [treeControl]=\"treeControl\">\r\n              <!-- Leaf node without children -->\r\n              <mat-tree-node *matTreeNodeDef=\"let node\" matTreeNodeToggle matTreeNodePadding>\r\n                <button type=\"button\" mat-icon-button disabled matTreeNodeToggle class=\"a-tree-node-item-expand-toggle\"\r\n                  [id]=\"'a-tree-node-item-expand-toggle-'+node.RetailCategoryID\">\r\n                  <mat-icon class=\"mat-icon-rtl-mirror\">\r\n                  </mat-icon>\r\n                </button>\r\n                <div class=\"a-tree-node-draggable\" draggable=\"true\"\r\n                  [ngClass]=\"{'a-tree-node-item-drop-above': dragNodeExpandOverArea === dropOverAreaType.Above && dragNodeExpandOverNode === node,\r\n                                                    'a-tree-node-item-drop-below': dragNodeExpandOverArea === dropOverAreaType.Below && dragNodeExpandOverNode === node,\r\n                                                    'a-tree-node-item-drop-center': dragNodeExpandOverArea === dropOverAreaType.Center && dragNodeExpandOverNode === node}\"\r\n                  (dragstart)=\"handleDragStart($event, node);\" (dragover)=\"handleDragOver($event, node);\"\r\n                  (dragend)=\"handleDragEnd($event)\" (drop)=\"handleDrop($event, node);\"\r\n                  [id]=\"'a-tree-node-item-draggable-'+ node.RetailCategoryID\">\r\n                  <span class=\"checklist-leaf-node d-flex align-items-center\">\r\n                    <span class=\"a-text-primary nodeContent\">\r\n                      {{node.CategoryName}}\r\n                    </span>\r\n                  </span>\r\n                </div>\r\n                <div class=\"\">\r\n                  <button class=\"a-more-button\" mat-icon-button [matMenuTriggerFor]=\"catnodeemenu\" type=\"button\">\r\n                    <mat-icon>more_vert</mat-icon>\r\n                  </button>\r\n                  <mat-menu #catnodeemenu=\"matMenu\">\r\n                    <button mat-menu-item type=\"button\" class=\"a-manage-page\"\r\n                      [id]=\"'a-manage-page-'+ node.RetailCategoryID\" (click)=\"openEditCategoryDialog(node)\">\r\n                      <mat-icon>create</mat-icon>\r\n                      <span>{{'RETAIL_RETAIL_ADMIN.CATEGORIES.EDIT' | teiTextTranslate}}</span>\r\n                    </button>\r\n                    <button mat-menu-item type=\"button\" class=\"a-remove-page\"\r\n                      [id]=\"'a-remove-page-'+ node.RetailCategoryID\" (click)=\"openRemoveCategoryDialog(node)\">\r\n                      <mat-icon>delete_forever</mat-icon>\r\n                      <span>{{'RETAIL_RETAIL_ADMIN.CATEGORIES.DELETE' | teiTextTranslate}}</span>\r\n                    </button>\r\n                  </mat-menu>\r\n                </div>\r\n              </mat-tree-node>\r\n\r\n              <!-- Node with children -->\r\n              <mat-tree-node *matTreeNodeDef=\"let node; when: hasChild\" matTreeNodePadding>\r\n                <button type=\"button\" mat-icon-button matTreeNodeToggle class=\"a-tree-node-item-expand-toggle\"\r\n                  [id]=\"'a-tree-node-item-expand-toggle-'+ node.RetailCategoryID\">\r\n                  <mat-icon class=\"mat-icon-rtl-mirror\">\r\n                    {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}\r\n                  </mat-icon>\r\n                </button>\r\n                <div class=\"a-tree-node-draggable\" draggable=\"true\" (dragstart)=\"handleDragStart($event, node);\"\r\n                  (dragover)=\"handleDragOver($event, node);\" (dragend)=\"handleDragEnd($event)\"\r\n                  (drop)=\"handleDrop($event, node);\"\r\n                  [ngClass]=\"{'a-tree-node-item-drop-above': dragNodeExpandOverArea === dropOverAreaType.Above && dragNodeExpandOverNode === node,\r\n                                                    'a-tree-node-item-drop-below': dragNodeExpandOverArea === dropOverAreaType.Below && dragNodeExpandOverNode === node,\r\n                                                    'a-tree-node-item-drop-center': dragNodeExpandOverArea === dropOverAreaType.Center && dragNodeExpandOverNode === node}\"\r\n                  [id]=\"'a-tree-node-item-draggable-'+node.RetailCategoryID\">\r\n                  <span class=\"checklist-leaf-node d-flex align-items-center\">\r\n                    <span class=\"a-text-primary nodeContent\">\r\n                      {{node.CategoryName}}\r\n                    </span>\r\n                  </span>\r\n                </div>\r\n                <div class=\"\">\r\n                  <button mat-icon-button class=\"a-more-button\" [matMenuTriggerFor]=\"catleafemenu\" type=\"button\">\r\n                    <mat-icon>more_vert</mat-icon>\r\n                  </button>\r\n                  <mat-menu #catleafemenu=\"matMenu\">\r\n                    <button mat-menu-item type=\"button\" class=\"a-manage-page\"\r\n                      [id]=\"'a-manage-page-'+ node.RetailCategoryID\" (click)=\"openEditCategoryDialog(node)\">\r\n                      <mat-icon>create</mat-icon>\r\n                      <mat-label class=\"a-text-label\">{{'RETAIL_RETAIL_ADMIN.CATEGORIES.EDIT' |\r\n                        teiTextTranslate}}</mat-label>\r\n                    </button>\r\n                    <button mat-menu-item type=\"button\" class=\"a-remove-page\"\r\n                      [id]=\"'a-remove-page-'+ node.RetailCategoryID\" (click)=\"openRemoveCategoryDialog(node)\">\r\n                      <mat-icon>delete_forever</mat-icon>\r\n                      <mat-label class=\"a-text-label\">{{'RETAIL_RETAIL_ADMIN.CATEGORIES.DELETE' |\r\n                        teiTextTranslate}}</mat-label>\r\n                    </button>\r\n                  </mat-menu>\r\n                </div>\r\n              </mat-tree-node>\r\n            </mat-tree>\r\n            <span #emptyItem></span>\r\n          </div>\r\n        </mat-card>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</tei-retail-retail-admin-right-side-action-bar-page-template>\r\n<tei-loading [show]=\"isLoading\"></tei-loading>","import { FlatTreeControl } from '@angular/cdk/tree';\r\nimport { Component, ElementRef, Inject, OnInit, ViewChild } from '@angular/core';\r\nimport { MatLegacyDialog as MatDialog } from '@angular/material/legacy-dialog';\r\nimport { MatTreeFlatDataSource, MatTreeFlattener } from '@angular/material/tree';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { BreadCrumb, SnackBarService } from '@tei/material';\r\nimport { Observable, delay, filter, finalize, firstValueFrom, switchMap, take, tap } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { IRetailCategoriesService } from '../../../../@intermediate/retail-categories/retail-categories.interface';\r\nimport { DropOverAreaType, FlatRetailCategoryItem, RetailCategoryItem, RetailCategoryItemJagged } from '../../../../@intermediate/retail-categories/retail-categories.model';\r\nimport { RetailCategoriesService } from '../../../../@services/retail-categories.service';\r\nimport { TreeListMenuActionsService } from '../../../../@services/tree-list-menu-actions.service';\r\nimport { RetailAddCategoryDialogComponent } from '../../../../components/retail-add-category-dialog/retail-add-category-dialog.component';\r\nimport { RetailDeleteCategoryDialogComponent } from '../../../../components/retail-delete-category-dialog/retail-delete-category-dialog.component';\r\nimport { RetailEditCategoryDialogComponent } from '../../../../components/retail-edit-category-dialog/retail-edit-category-dialog.component';\r\n\r\n@Component({\r\n  selector: 'tei-retail-admin-site-online-setup-categories',\r\n  templateUrl: './site-online-setup-categories.component.html',\r\n  styleUrls: ['./site-online-setup-categories.component.scss'],\r\n  providers: [\r\n    { provide: 'IRetailCategoriesService', useClass: RetailCategoriesService },\r\n    { provide: 'Database', useClass: TreeListMenuActionsService }\r\n  ]\r\n})\r\nexport class SiteOnlineSetupCategoriesComponent implements OnInit\r\n{\r\n  @ViewChild('emptyItem') emptyItem: ElementRef;\r\n\r\n  isLoading = false;\r\n  showAddCategoryButton: boolean = false;\r\n  siteId$: Observable<string>;\r\n\r\n  dataSource: MatTreeFlatDataSource<RetailCategoryItem, FlatRetailCategoryItem>;\r\n  treeFlattener: MatTreeFlattener<RetailCategoryItem, FlatRetailCategoryItem>;\r\n  nestedNodeMap = new Map<RetailCategoryItem, FlatRetailCategoryItem>();\r\n  getLevel = (node: FlatRetailCategoryItem) => node.Level;\r\n  isExpandable = (node: FlatRetailCategoryItem) => node.expandable;\r\n  getChildren = (node: RetailCategoryItem): RetailCategoryItem[] => node.Childs;\r\n  flatNodeMap = new Map<FlatRetailCategoryItem, RetailCategoryItem>();\r\n  treeControl: FlatTreeControl<FlatRetailCategoryItem>;\r\n  hasChild = (_: number, _nodeData: FlatRetailCategoryItem) => _nodeData.expandable;\r\n  dropOverAreaType = DropOverAreaType;\r\n\r\n  // To keep track of expanded nodes\r\n  expandedNodeIds: Set<number> = new Set<number>();\r\n\r\n  /* Drag and drop */\r\n  dragNode: FlatRetailCategoryItem;\r\n  dragNodeExpandOverWaitTimeMs = 500;\r\n  dragNodeExpandOverNode: FlatRetailCategoryItem;\r\n  dragNodeExpandOverTime: number;\r\n  dragNodeExpandOverArea: DropOverAreaType;\r\n  lastDragOverTarget: Element;\r\n  retailCategoryItemJagged: RetailCategoryItemJagged[] = [];\r\n  retailCategoryItem: RetailCategoryItem[] = [];\r\n\r\n  breadCrumbData: BreadCrumb[] = [\r\n    {\r\n      title: this.translate.instant('RETAIL_RETAIL_ADMIN.SITES_CONFIGS.SITES_TABLE.SETUP'),\r\n      relativeUrl: '../../../'\r\n    },\r\n    {\r\n      title: this.translate.instant('RETAIL_RETAIL_ADMIN.SITES_CONFIGS.SITES_TABLE.SITES'),\r\n      relativeUrl: '../../'\r\n    },\r\n    {\r\n      title: this.translate.instant('RETAIL_RETAIL_ADMIN.SITES_CONFIGS.SITES_TABLE.ONLINE_SETUP'),\r\n      relativeUrl: '../online-setup'\r\n    },\r\n    {\r\n      title: this.translate.instant('RETAIL_RETAIL_ADMIN.CATEGORIES.CATEGORIES'),\r\n      relativeUrl: ''\r\n    }\r\n  ];\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    private translate: TranslateService,\r\n    private dialog: MatDialog,\r\n    private snackBarService: SnackBarService,\r\n    @Inject('IRetailCategoriesService') private categoriesService: IRetailCategoriesService,\r\n    @Inject('Database') private database: TreeListMenuActionsService,\r\n  )\r\n  {\r\n    // Extract siteId from the activated route\r\n    this.siteId$ = this.route.paramMap.pipe(\r\n      map(params => params.get('siteId') || '')\r\n    );\r\n\r\n    this.treeControl = new FlatTreeControl<FlatRetailCategoryItem>(this.getLevel, this.isExpandable);\r\n    this.treeFlattener = new MatTreeFlattener(this.transformer, this.getLevel, this.isExpandable, this.getChildren);\r\n    this.dataSource = new MatTreeFlatDataSource(this.treeControl, this.treeFlattener);\r\n  }\r\n\r\n  ngOnInit(): void\r\n  {\r\n    this.configureTree();\r\n    this.getCategories();\r\n  }\r\n\r\n  configureTree(): void\r\n  {\r\n    this.database.dataChange.subscribe(data =>\r\n    {\r\n      this.dataSource.data = data;\r\n    });\r\n  }\r\n\r\n  getCategories(): void\r\n  {\r\n    this.saveExpandedNodes();\r\n\r\n    this.flatNodeMap.clear();\r\n    this.nestedNodeMap.clear();\r\n\r\n    this.isLoading = true;\r\n\r\n    this.siteId$.pipe(\r\n      take(1),\r\n      switchMap(siteId => this.categoriesService.Get(siteId)),\r\n      delay(200),\r\n      finalize(() =>\r\n      {\r\n        this.isLoading = false;\r\n        this.showAddCategoryButton = true;\r\n      })\r\n    ).subscribe({\r\n      next: (result) =>\r\n      {\r\n        if (result.Categories)\r\n        {\r\n          this.fixChildrenProperty(result.Categories);\r\n        }\r\n\r\n        this.database.initialize(result.Categories);\r\n        this.database.reviseSortOrder();\r\n        this.retailCategoryItemJagged = result.EcommerceCategoriesJagged;\r\n        this.retailCategoryItem = result.Categories;\r\n\r\n        this.expandSavedExpandedNodes();\r\n      },\r\n      error: () =>\r\n      {\r\n        this.showErrorMessage('RETAIL_RETAIL_ADMIN.CATEGORIES.LOAD_ERROR');\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  findNode(categoryID: number): FlatRetailCategoryItem\r\n  {\r\n    let selectedCategory: FlatRetailCategoryItem;\r\n    this.flatNodeMap.forEach((value: RetailCategoryItem, key: FlatRetailCategoryItem) => \r\n    {\r\n      if (key.RetailCategoryID === categoryID)\r\n      {\r\n        selectedCategory = key;\r\n      }\r\n    });\r\n    return selectedCategory;\r\n  }\r\n  /**\r\n   * Fix any naming inconsistencies in the children property\r\n   * (Some APIs use 'Childs', others use 'Children')\r\n   */\r\n  private fixChildrenProperty(categories: RetailCategoryItem[]): void\r\n  {\r\n    categories.forEach(category =>\r\n    {\r\n      // Check if we need to rename the property\r\n      if (category['Children'] && !category.Childs)\r\n      {\r\n        category.Childs = category['Children'];\r\n      }\r\n\r\n      // Ensure the Childs array is properly initialized\r\n      if (!category.Childs)\r\n      {\r\n        category.Childs = [];\r\n      }\r\n\r\n      // Process children recursively\r\n      if (category.Childs && category.Childs.length > 0)\r\n      {\r\n        this.fixChildrenProperty(category.Childs);\r\n      }\r\n    });\r\n  }\r\n\r\n  // Save expanded nodes before refresh\r\n  private saveExpandedNodes(): void\r\n  {\r\n    this.expandedNodeIds.clear();\r\n    if (this.treeControl)\r\n    {\r\n      const expandedNodes = this.treeControl.dataNodes.filter(node =>\r\n        this.treeControl.isExpanded(node));\r\n\r\n      expandedNodes.forEach(node =>\r\n      {\r\n        this.expandedNodeIds.add(node.RetailCategoryID);\r\n      });\r\n\r\n    }\r\n  }\r\n\r\n  private expandSavedExpandedNodes(): void\r\n  {\r\n    this.expandedNodeIds.forEach(nodeId =>\r\n    {\r\n      this.treeControl.expand(this.findNode(nodeId));\r\n    });\r\n  }\r\n\r\n  transformer = (node: RetailCategoryItem, level: number) =>\r\n  {\r\n    const existingNode = this.nestedNodeMap.get(node);\r\n    const flatNode = existingNode && existingNode.CategoryName === node.CategoryName\r\n      ? existingNode\r\n      : new FlatRetailCategoryItem();\r\n\r\n    flatNode.CategoryName = node.CategoryName;\r\n    flatNode.Level = level;\r\n    flatNode.ParentID = node.ParentID;\r\n    flatNode.RetailCategoryID = node.CategoryID;\r\n\r\n    // Check if this node has children\r\n    const hasChildren = node.Childs && node.Childs.length > 0;\r\n    flatNode.expandable = hasChildren;\r\n\r\n    // Store the mapping for later use\r\n    this.flatNodeMap.set(flatNode, node);\r\n    this.nestedNodeMap.set(node, flatNode);\r\n\r\n    return flatNode;\r\n  };\r\n\r\n  async openCreateCategoryDialog(): Promise<void>\r\n  {\r\n    this.getCategories();\r\n\r\n    const addCategoryDialog = this.dialog.open(RetailAddCategoryDialogComponent, {\r\n      panelClass: ['o-dialog-sm-fullscreen', 'o-dialog-md-fullscreen', 'retail-add-category-dialog'],\r\n      width: '460px',\r\n      data: { retailCategoryItemJagged: this.retailCategoryItemJagged, siteId: await firstValueFrom(this.siteId$) }\r\n    });\r\n\r\n    // Use better observable chaining to avoid nested subscriptions\r\n    addCategoryDialog.afterClosed()\r\n      .subscribe({\r\n        next: (result) =>\r\n        {\r\n          if (result)\r\n          {\r\n            this.showSuccessMessage('RETAIL_RETAIL_ADMIN.CATEGORIES.CATEGORY_SAVED');\r\n            this.getCategories();\r\n          }\r\n        },\r\n        error: () =>\r\n        {\r\n          this.showErrorMessage('RETAIL_RETAIL_ADMIN.CATEGORIES.CREATE_ERROR');\r\n        }\r\n      });\r\n  }\r\n\r\n  findCategoryById(\r\n    items: RetailCategoryItem[],\r\n    categoryId: number\r\n  ): RetailCategoryItem | undefined\r\n  {\r\n    for (const item of items)\r\n    {\r\n      if (item.CategoryID === categoryId)\r\n      {\r\n        return item;\r\n      }\r\n      if (item.Childs?.length)\r\n      {\r\n        const found = this.findCategoryById(item.Childs, categoryId);\r\n        if (found)\r\n        {\r\n          return found;\r\n        }\r\n      }\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  async openEditCategoryDialog(node: FlatRetailCategoryItem): Promise<void>\r\n  {\r\n    // Validate node\r\n    if (!node || typeof node.RetailCategoryID !== 'number')\r\n    {\r\n      this.showErrorMessage('RETAIL_RETAIL_ADMIN.CATEGORIES.EDIT_ERROR');\r\n      return;\r\n    }\r\n\r\n    // Get category data\r\n    const category = this.findCategoryById(this.retailCategoryItem, node.RetailCategoryID);\r\n    if (!category)\r\n    {\r\n      this.showErrorMessage('RETAIL_RETAIL_ADMIN.CATEGORIES.EDIT_ERROR');\r\n      return;\r\n    }\r\n\r\n    // Open dialog\r\n    const editCategoryDialog = this.dialog.open(RetailEditCategoryDialogComponent, {\r\n      panelClass: ['o-dialog-sm-fullscreen', 'o-dialog-md-fullscreen', 'retail-edit-category-dialog'],\r\n      width: '460px',\r\n      data: {\r\n        retailCategoryItemJagged: this.retailCategoryItemJagged.filter(\r\n          item => item.CategoryID !== category.CategoryID\r\n        ),\r\n        retailCategoryItem: category,\r\n        siteId: await firstValueFrom(this.siteId$)\r\n      }\r\n    });\r\n\r\n    // Use better observable chaining to avoid nested subscriptions\r\n    editCategoryDialog.afterClosed()\r\n      .subscribe({\r\n        next: (result) =>\r\n        {\r\n          if (result)\r\n          {\r\n            this.showSuccessMessage('RETAIL_RETAIL_ADMIN.CATEGORIES.CATEGORY_SAVED');\r\n            this.getCategories();\r\n          }\r\n        },\r\n        error: () =>\r\n        {\r\n          this.showErrorMessage('RETAIL_RETAIL_ADMIN.CATEGORIES.EDIT_ERROR');\r\n        }\r\n      });\r\n  }\r\n\r\n  // Helper methods to reduce duplication\r\n  private showErrorMessage(messageKey: string): void\r\n  {\r\n    this.snackBarService.showError(this.translate.instant(messageKey), '', null, 'left');\r\n  }\r\n\r\n  private showSuccessMessage(messageKey: string): void\r\n  {\r\n    this.snackBarService.showSuccess(\r\n      this.translate.instant(messageKey),\r\n      '', null, 'left', 'bottom'\r\n    );\r\n  }\r\n\r\n  openRemoveCategoryDialog(node: FlatRetailCategoryItem): void\r\n  {\r\n    // Validate node\r\n    if (!node || typeof node.RetailCategoryID !== 'number')\r\n    {\r\n      this.showErrorMessage('RETAIL_RETAIL_ADMIN.CATEGORIES.DELETE_ERROR');\r\n      return;\r\n    }\r\n\r\n    // Get category data\r\n    const retailCategoryItem = this.findCategoryById(this.retailCategoryItem, node.RetailCategoryID);\r\n    if (!retailCategoryItem)\r\n    {\r\n      this.showErrorMessage('RETAIL_RETAIL_ADMIN.CATEGORIES.DELETE_ERROR');\r\n      return;\r\n    }\r\n\r\n    // Validate category ID\r\n    if (typeof retailCategoryItem.CategoryID !== 'number')\r\n    {\r\n      this.showErrorMessage('RETAIL_RETAIL_ADMIN.CATEGORIES.DELETE_ERROR');\r\n      return;\r\n    }\r\n\r\n    // Open dialog\r\n    const deleteCategoryDialog = this.dialog.open(RetailDeleteCategoryDialogComponent, {\r\n      panelClass: ['o-dialog-sm-fullscreen', 'o-dialog-md-fullscreen', 'retail-delete-category-dialog'],\r\n      width: '460px',\r\n      data: retailCategoryItem\r\n    });\r\n\r\n    // Use better observable chaining to avoid nested subscriptions\r\n    deleteCategoryDialog.afterClosed()\r\n      .pipe(\r\n        // Only proceed if confirmed\r\n        filter(result => !!result),\r\n        // Start loading indicator\r\n        tap(() => this.isLoading = true),\r\n        // Delete the category\r\n        switchMap(() => this.categoriesService.Delete(retailCategoryItem.CategoryID)),\r\n        // Ensure loading finishes even if there's an error\r\n        finalize(() => this.isLoading = false)\r\n      )\r\n      .subscribe({\r\n        next: () =>\r\n        {\r\n          this.showSuccessMessage('RETAIL_RETAIL_ADMIN.CATEGORIES.CATEGORY_DELETED');\r\n          this.getCategories();\r\n        },\r\n        error: () =>\r\n        {\r\n          this.showErrorMessage('RETAIL_RETAIL_ADMIN.CATEGORIES.DELETE_ERROR');\r\n        }\r\n      });\r\n  }\r\n\r\n  handleDragStart(event: any, node: FlatRetailCategoryItem): void\r\n  {\r\n    if (event.dataTransfer)\r\n      event.dataTransfer.setDragImage(this.emptyItem.nativeElement, 0, 0);\r\n    this.dragNode = node;\r\n    this.treeControl.collapse(node);\r\n\r\n    const targetElement = event.target as HTMLElement;\r\n    targetElement.classList.add('dragged');\r\n  }\r\n\r\n  handleDragOver(event: any, node: FlatRetailCategoryItem): void\r\n  {\r\n    event.preventDefault();\r\n    // Handle node expand\r\n    if (node === this.dragNodeExpandOverNode)\r\n    {\r\n\r\n    } else\r\n    {\r\n      this.dragNodeExpandOverNode = node;\r\n      this.dragNodeExpandOverTime = new Date().getTime();\r\n    }\r\n\r\n\r\n    let isValidToBeBelow = false;\r\n    let currentNode = this.flatNodeMap.get(node);\r\n    let parent = this.database.getParentFromNodes(currentNode);\r\n    if (parent == null)\r\n    {\r\n      let items = this.database.data;\r\n      isValidToBeBelow = items.indexOf(currentNode) == items.length - 1;\r\n    } else\r\n    {\r\n      isValidToBeBelow = parent.Childs.indexOf(currentNode) == parent.Childs.length - 1;\r\n    }\r\n\r\n    // Handle drag area\r\n    const target = event.currentTarget || event.target;\r\n    let percentageY = event.offsetY / target.clientHeight;\r\n    let centerThreshold = 0.75;\r\n    if (!isValidToBeBelow)\r\n      centerThreshold = 1.0;\r\n\r\n    if (percentageY < 0.25)\r\n    {\r\n      this.dragNodeExpandOverArea = DropOverAreaType.Above;\r\n    }\r\n    else if (percentageY >= 0.25 && percentageY <= centerThreshold)\r\n    {\r\n      this.dragNodeExpandOverArea = DropOverAreaType.Center;\r\n    }\r\n    else if (percentageY > 0.75 && percentageY <= 1 && isValidToBeBelow)\r\n    {\r\n      this.dragNodeExpandOverArea = DropOverAreaType.Below;\r\n    }\r\n    else\r\n    {\r\n      this.dragNodeExpandOverArea = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Validates both drag and target nodes and returns a boolean indicating if they're valid\r\n   */\r\n  private validateDragNodes(draggedNode: FlatRetailCategoryItem, targetNode: FlatRetailCategoryItem): boolean\r\n  {\r\n    if (!draggedNode || !targetNode)\r\n    {\r\n      return false;\r\n    }\r\n\r\n    const draggedItem = this.flatNodeMap.get(draggedNode);\r\n    const targetItem = this.flatNodeMap.get(targetNode);\r\n\r\n    if (!draggedItem || !targetItem)\r\n    {\r\n      return false;\r\n    }\r\n\r\n    // Determine the target parent level for validation\r\n    let targetParentLevel = 0;\r\n\r\n    if (this.dragNodeExpandOverArea === DropOverAreaType.Above || this.dragNodeExpandOverArea === DropOverAreaType.Below)\r\n    {\r\n      // When dropping above or below, the dragged item becomes a sibling of the target node\r\n      targetParentLevel = targetNode.Level;\r\n    }\r\n    else if (this.dragNodeExpandOverArea === DropOverAreaType.Center)\r\n    {\r\n      // When dropping in the center, the dragged item becomes a child of the target node\r\n      targetParentLevel = targetNode.Level;\r\n    }\r\n\r\n    // Validate if the drop would exceed 4 levels\r\n    if (this.database.wouldExceedMaxLevels(draggedItem, targetParentLevel, 3))\r\n    {\r\n      this.snackBarService.showError(\r\n        this.translate.instant('RETAIL_RETAIL_ADMIN.CATEGORIES.MAX_NESTING_LEVEL_ERROR'),\r\n        \"\",\r\n        null,\r\n        \"left\",\r\n        \"bottom\"\r\n      );\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Calculate the appropriate parent ID based on drop area and node properties\r\n   */\r\n  private calculateParentId(targetNode: FlatRetailCategoryItem, dropArea: DropOverAreaType): number | null\r\n  {\r\n    if (dropArea !== DropOverAreaType.Center && !targetNode.ParentID)\r\n    {\r\n      return null;\r\n    }\r\n    else if (dropArea !== DropOverAreaType.Center && targetNode.ParentID)\r\n    {\r\n      return targetNode.ParentID;\r\n    }\r\n    else if (dropArea === DropOverAreaType.Center)\r\n    {\r\n      return targetNode.RetailCategoryID;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Calculate the appropriate sort order based on drop area and target node\r\n   */\r\n  private calculateSortOrder(targetNode: FlatRetailCategoryItem, dropArea: DropOverAreaType): number\r\n  {\r\n    if (dropArea === DropOverAreaType.Above || dropArea === DropOverAreaType.Below)\r\n    {\r\n      // Get target's position - same calculation for both above and below\r\n      const targetParent = this.findParentNodeFlat(targetNode);\r\n\r\n      // Get all nodes at the same level\r\n      const siblings = this.treeControl.dataNodes.filter(n =>\r\n      {\r\n        if (targetParent)\r\n        {\r\n          return n.ParentID === targetParent.RetailCategoryID;\r\n        } else\r\n        {\r\n          return !n.ParentID || n.ParentID === 0;\r\n        }\r\n      });\r\n\r\n      // Find target's position among siblings\r\n      const targetIndex = siblings.findIndex(n => n.RetailCategoryID === targetNode.RetailCategoryID);\r\n      return targetIndex + 1; // Convert to 1-based index\r\n    } else\r\n    {\r\n      // Center - as a child, it will be the first child\r\n      return 1;\r\n    }\r\n  }\r\n\r\n  handleDrop(event: DragEvent, node: FlatRetailCategoryItem): void\r\n  {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    // Try to recover dragNode if missing\r\n    if (!this.dragNode && event.dataTransfer.getData('text/plain'))\r\n    {\r\n      const draggedId = parseInt(event.dataTransfer.getData('text/plain'), 10);\r\n      this.dragNode = this.treeControl.dataNodes.find(n => n.RetailCategoryID === draggedId);\r\n    }\r\n\r\n    // Exit if no drag node or same node\r\n    if (!this.dragNode || node === this.dragNode)\r\n    {\r\n      this.resetDragState();\r\n      return;\r\n    }\r\n\r\n    this.isLoading = true;\r\n\r\n    // Validate nodes before proceeding\r\n    if (!this.validateDragNodes(this.dragNode, node))\r\n    {\r\n      this.isLoading = false;\r\n      this.resetDragState();\r\n      return;\r\n    }\r\n\r\n    const draggedItem = this.flatNodeMap.get(this.dragNode);\r\n    const targetItem = this.flatNodeMap.get(node);\r\n    const parentId = this.calculateParentId(node, this.dragNodeExpandOverArea);\r\n    const sortOrder = this.calculateSortOrder(node, this.dragNodeExpandOverArea);\r\n\r\n    // Update UI tree structure based on drop area\r\n    let newItem: RetailCategoryItem;\r\n    if (this.dragNodeExpandOverArea === DropOverAreaType.Above)\r\n    {\r\n      newItem = this.database.copyPasteItemAbove(draggedItem, targetItem);\r\n    } else if (this.dragNodeExpandOverArea === DropOverAreaType.Below)\r\n    {\r\n      newItem = this.database.copyPasteItemBelow(draggedItem, targetItem);\r\n    } else\r\n    {\r\n      newItem = this.database.copyPasteItem(draggedItem, targetItem);\r\n    }\r\n\r\n    this.database.deleteItem(draggedItem);\r\n\r\n    // Expand the node if it has children\r\n    const newFlatNode = this.nestedNodeMap.get(newItem);\r\n    if (newFlatNode?.expandable)\r\n    {\r\n      this.treeControl.expand(newFlatNode);\r\n    }\r\n\r\n    // Update backend\r\n    this.siteId$.pipe(\r\n      take(1),\r\n      switchMap(siteId => this.categoriesService.SortOrder({\r\n        ECommItemCategoryID: draggedItem.CategoryID,\r\n        DisplayOrder: sortOrder,\r\n        ParentID: parentId,\r\n        InstanceID: siteId\r\n      }))\r\n    ).subscribe(\r\n      {\r\n        next: () =>\r\n        {\r\n          // Success handling\r\n        },\r\n        error: () =>\r\n        {\r\n          this.snackBarService.showError(\r\n            this.translate.instant('RETAIL_RETAIL_ADMIN.CATEGORIES.SORT_ERROR'),\r\n            '', null, 'left', 'bottom'\r\n          );\r\n          this.isLoading = false;\r\n        },\r\n        complete: () =>\r\n        {\r\n          this.snackBarService.showSuccess(\r\n            this.translate.instant('RETAIL_RETAIL_ADMIN.CATEGORIES.CATEGORY_SAVED'),\r\n            '', null, 'left', 'bottom'\r\n          );\r\n          this.getCategories();\r\n          this.resetDragState();\r\n        }\r\n      }\r\n    );\r\n\r\n    this.handleDragEnd(event);\r\n  }\r\n\r\n  // Helper method to find parent node for flat nodes\r\n  findParentNodeFlat(node: FlatRetailCategoryItem): FlatRetailCategoryItem | null\r\n  {\r\n    if (!node.ParentID)\r\n    {\r\n      return null; // No parent, root level\r\n    }\r\n\r\n    // Find node with RetailCategoryID matching ParentID\r\n    return this.treeControl.dataNodes.find(n => n.RetailCategoryID === node.ParentID) || null;\r\n  }\r\n\r\n  findParentNode(node: FlatRetailCategoryItem): FlatRetailCategoryItem\r\n  {\r\n    const nodes = this.treeControl.dataNodes;\r\n    const nodeLevel = node.Level;\r\n\r\n    for (let i = nodes.indexOf(node) - 1; i >= 0; i--)\r\n    {\r\n      if (nodes[i].Level < nodeLevel)\r\n      {\r\n        return nodes[i];\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  handleDragEnd(event: DragEvent): void\r\n  {\r\n    const targetElement = event.target as HTMLElement;\r\n    targetElement.classList.remove('dragged');\r\n    if (event.dataTransfer.dropEffect == \"none\")\r\n      this.resetDragState();\r\n  }\r\n\r\n  private resetDragState(): void\r\n  {\r\n    this.dragNode = null;\r\n    this.dragNodeExpandOverNode = null;\r\n    this.dragNodeExpandOverTime = 0;\r\n    this.dragNodeExpandOverArea = null;\r\n  }\r\n\r\n  trackById(index: number, node: FlatRetailCategoryItem): number\r\n  {\r\n    return node.RetailCategoryID;\r\n  }\r\n}","import { DragDropModule } from '@angular/cdk/drag-drop';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { MatDividerModule } from '@angular/material/divider';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatLegacyButtonModule as MatButtonModule } from '@angular/material/legacy-button';\r\nimport { MatLegacyCardModule as MatCardModule } from '@angular/material/legacy-card';\r\nimport { MatLegacyOptionModule as MatOptionModule } from '@angular/material/legacy-core';\r\nimport { MatLegacyDialogModule as MatDialogModule } from '@angular/material/legacy-dialog';\r\nimport { MatLegacyFormFieldModule as MatFormFieldModule } from '@angular/material/legacy-form-field';\r\nimport { MatLegacyInputModule as MatInputModule } from '@angular/material/legacy-input';\r\nimport { MatLegacyMenuModule as MatMenuModule } from '@angular/material/legacy-menu';\r\nimport { MatLegacySelectModule as MatSelectModule } from '@angular/material/legacy-select';\r\nimport { MatTreeModule } from '@angular/material/tree';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { TeiTextTranslatePipeModule } from '@tei/core-translate';\r\nimport { BreadCrumbModule, LoadingModule } from '@tei/material';\r\nimport { RetailAddCategoryDialogModule } from '../../../../components/retail-add-category-dialog/retail-add-category-dialog.module';\r\nimport { RetailDeleteCategoryDialogModule } from '../../../../components/retail-delete-category-dialog/retail-delete-category-dialog.module';\r\nimport { RetailEditCategoryDialogModule } from '../../../../components/retail-edit-category-dialog/retail-edit-category-dialog.module';\r\nimport { RightSideActionBarPageTemplateModule } from '../../../../components/right-side-action-bar-page-template/right-side-action-bar-page-template.module';\r\nimport { SiteOnlineSetupCategoriesComponent } from './site-online-setup-categories.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: SiteOnlineSetupCategoriesComponent\r\n  }\r\n];\r\n\r\nconst COMMON_MODULES = [CommonModule, FormsModule, ReactiveFormsModule, RouterModule];\r\nconst COMPONENT = [SiteOnlineSetupCategoriesComponent];\r\nconst CORE_MODULES = [\r\n  TeiTextTranslatePipeModule\r\n];\r\nconst MATERIAL_MODULES = [\r\n  MatTreeModule,\r\n  MatIconModule,\r\n  MatDialogModule,\r\n  DragDropModule,\r\n  MatButtonModule,\r\n  MatFormFieldModule,\r\n  MatSelectModule,\r\n  MatCardModule,\r\n  MatMenuModule,\r\n  MatInputModule,\r\n  MatDividerModule,\r\n  MatOptionModule\r\n];\r\nconst TEI_MATERIAL_MODULES = [\r\n  LoadingModule,\r\n  BreadCrumbModule\r\n];\r\nconst TEI_RETAIL_ADMIN_MODULES = [\r\n  RightSideActionBarPageTemplateModule,\r\n  RetailAddCategoryDialogModule,\r\n  RetailEditCategoryDialogModule,\r\n  RetailDeleteCategoryDialogModule\r\n];\r\n\r\n@NgModule({\r\n  declarations: [...COMPONENT],\r\n  imports: [\r\n    ...MATERIAL_MODULES,\r\n    ...TEI_MATERIAL_MODULES,\r\n    ...CORE_MODULES,\r\n    ...COMMON_MODULES,\r\n    ...TEI_RETAIL_ADMIN_MODULES,\r\n    RouterModule.forChild(routes)\r\n  ],\r\n  exports: [\r\n    ...COMPONENT\r\n  ]\r\n})\r\nexport class SiteOnlineSetupCategoriesModule { } "],"names":["rf","ctx_r0","SiteOnlineSetupCategoriesComponent_button_13_Template","ctx","_r6","ctx_r5","openCreateCategoryDialog","_c1","a0","a1","a2","SiteOnlineSetupCategoriesComponent_mat_tree_node_17_Template","_r10","ctx_r9","handleDragStart","$event","node_r7","SiteOnlineSetupCategoriesComponent_mat_tree_node_17_Template_div_dragover_3_listener","restoredCtx","ctx_r11","handleDragOver","SiteOnlineSetupCategoriesComponent_mat_tree_node_17_Template_div_dragend_3_listener","ctx_r12","handleDragEnd","SiteOnlineSetupCategoriesComponent_mat_tree_node_17_Template_div_drop_3_listener","ctx_r13","handleDrop","ctx_r14","openEditCategoryDialog","ctx_r15","openRemoveCategoryDialog","$implicit","_r8","RetailCategoryID","SiteOnlineSetupCategoriesComponent_mat_tree_node_18_Template","_r19","ctx_r18","node_r16","SiteOnlineSetupCategoriesComponent_mat_tree_node_18_Template_div_dragover_4_listener","ctx_r20","SiteOnlineSetupCategoriesComponent_mat_tree_node_18_Template_div_dragend_4_listener","ctx_r21","SiteOnlineSetupCategoriesComponent_mat_tree_node_18_Template_div_drop_4_listener","ctx_r22","ctx_r23","ctx_r24","_r17","SiteOnlineSetupCategoriesComponent","constructor","route","translate","dialog","snackBarService","categoriesService","database","isLoading","showAddCategoryButton","nestedNodeMap","Map","getLevel","node","Level","isExpandable","expandable","getChildren","Childs","flatNodeMap","hasChild","_","_nodeData","dropOverAreaType","DropOverAreaType","expandedNodeIds","Set","dragNodeExpandOverWaitTimeMs","retailCategoryItemJagged","retailCategoryItem","breadCrumbData","title","instant","relativeUrl","transformer","level","existingNode","get","flatNode","CategoryName","FlatRetailCategoryItem","ParentID","CategoryID","hasChildren","length","set","siteId$","paramMap","pipe","map","params","treeControl","FlatTreeControl","treeFlattener","MatTreeFlattener","dataSource","MatTreeFlatDataSource","ngOnInit","configureTree","getCategories","dataChange","subscribe","data","saveExpandedNodes","clear","take","switchMap","siteId","Get","delay","finalize","next","result","Categories","fixChildrenProperty","initialize","reviseSortOrder","EcommerceCategoriesJagged","expandSavedExpandedNodes","error","showErrorMessage","findNode","categoryID","selectedCategory","forEach","value","key","categories","category","expandedNodes","dataNodes","filter","isExpanded","add","nodeId","expand","_this","_asyncToGenerator","addCategoryDialog","open","RetailAddCategoryDialogComponent","panelClass","width","firstValueFrom","afterClosed","showSuccessMessage","findCategoryById","items","categoryId","item","_item$Childs","found","undefined","_this2","editCategoryDialog","RetailEditCategoryDialogComponent","messageKey","showError","showSuccess","deleteCategoryDialog","RetailDeleteCategoryDialogComponent","tap","Delete","event","dataTransfer","setDragImage","emptyItem","nativeElement","dragNode","collapse","targetElement","target","classList","preventDefault","dragNodeExpandOverNode","dragNodeExpandOverTime","Date","getTime","isValidToBeBelow","currentNode","parent","getParentFromNodes","indexOf","currentTarget","percentageY","offsetY","clientHeight","centerThreshold","dragNodeExpandOverArea","Above","Center","Below","validateDragNodes","draggedNode","targetNode","draggedItem","targetItem","targetParentLevel","wouldExceedMaxLevels","calculateParentId","dropArea","calculateSortOrder","targetParent","findParentNodeFlat","siblings","n","targetIndex","findIndex","stopPropagation","getData","draggedId","parseInt","find","resetDragState","parentId","sortOrder","newItem","copyPasteItemAbove","copyPasteItemBelow","copyPasteItem","deleteItem","newFlatNode","SortOrder","ECommItemCategoryID","DisplayOrder","InstanceID","complete","findParentNode","nodes","nodeLevel","i","remove","dropEffect","trackById","index","i1","ActivatedRoute","i2","TranslateService","i3","MatLegacyDialog","i4","SnackBarService","cmp","selectors","viewQuery","SiteOnlineSetupCategoriesComponent_Query","provide","useClass","RetailCategoriesService","TreeListMenuActionsService","decls","vars","consts","template","SiteOnlineSetupCategoriesComponent_Template","dependencies","i5","MatTreeNodeDef","MatTreeNodePadding","MatTreeNodeToggle","MatTree","MatTreeNode","i6","MatIcon","i7","MatLegacyButton","i8","MatLegacyLabel","i9","MatLegacyCard","i10","MatLegacyMenu","MatLegacyMenuItem","MatLegacyMenuTrigger","i11","NgClass","NgIf","LoadingComponent","BreadCrumbComponent","i12.RightSideActionBarPageTemplateComponent","i13","TeiTextTranslatePipe","styles","Component","args","selector","providers","Inject","ViewChild","routes","path","component","COMMON_MODULES","CommonModule","FormsModule","ReactiveFormsModule","RouterModule","COMPONENT","CORE_MODULES","TeiTextTranslatePipeModule","MATERIAL_MODULES","MatTreeModule","MatIconModule","MatDialogModule","DragDropModule","MatButtonModule","MatFormFieldModule","MatSelectModule","MatCardModule","MatMenuModule","MatInputModule","MatDividerModule","MatOptionModule","TEI_MATERIAL_MODULES","LoadingModule","BreadCrumbModule","TEI_RETAIL_ADMIN_MODULES","RightSideActionBarPageTemplateModule","RetailAddCategoryDialogModule","RetailEditCategoryDialogModule","RetailDeleteCategoryDialogModule","SiteOnlineSetupCategoriesModule","inj","forChild","NgModule","declarations","imports","exports"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}